WindowManager:
    MainScreen:
    SendScreen:
    ReceiveScreen:

<ToggleSpinner@Spinner+ToggleButton>:
    #size_hint: 1, 1

<MainScreen>:  
    id: main
    name: "Main"
    
    PageLayout:
        BoxLayout:

            orientation: "vertical"
            spacing: 20
            padding_y: 20
            padding_x: 20

            BoxLayout:

                orientation: "vertical"
                spacing: 20
                padding: 20


                BoxLayout:
                
                    Label:
                        text: 'Balance'
                        size_hint: 1, 0.5
                        halign: "left"
                        valign: "bottom"
                        font_size: main.font_size
                        font_name: "Arial Black"
                    Button:
                        id: reload_button
                        background_normal: 'images/Reload-icon.png'
                        size_hint: 0.4, 0.85
                        size: 10,10
                        pos_hint: {'center_x':1, 'center_y': 0.25}
                        on_press: main.update_real_balance()
                        


                Label:
                    size_hint: 1, 1
                    halign: "auto"
                    valign: "middle"
                    font_name: "Arial Black"
                    font_size:  main.font_size
                    color: 0,1,0,1
                    canvas.before:
                        Color:
                            rgba: (0,1,0,1)
                        Line:
                            width: 2.1
                            rectangle: self.x, self.y, self.width, self.height
                    text: main.btc_balance_text

                Label:
                    size_hint: 1, 1
                    halign: "auto"
                    valign: "middle"
                    font_name: "Arial Black"
                    font_size:  main.font_size
                    color: 0,1,0,1
                    canvas.before:
                        Color:
                            rgba: (0,1,0,1)
                        Line:
                            width: 2.1
                            rectangle: self.x, self.y, self.width, self.height
                    text: main.usd_balance_text

            BoxLayout:
                orientation: "vertical"
                spacing: 20
                padding: 20
                
                Button:
                    size_hint: 1, 1
                    halign: "auto"
                    valign: "middle"
                    font_name: "Arial Black"
                    font_size: main.font_size
                    color: 1,1,1,1
                    background_color: 0.6,1,0.8,1
                    canvas.before:
                        Color:
                            rgba: (0,0.7,0,1)
                        Line:
                            width: 2.1
                            rectangle: self.x, self.y, self.width, self.height
                    text: 'SEND'
                    
                    on_press:
                        app.root.current = "Send"
                        root.manager.transition.direction = "left"  

                Button:
                    size_hint: 1, 1
                    halign: "auto"
                    valign: "middle"
                    font_name: "Arial Black"
                    font_size:  main.font_size
                    color: 1,1,1,1
                    background_color: 0.6,1,0.8,1
                    canvas.before:
                        Color:
                            rgba: (0,0.7,0,1)
                        Line:
                            width: 2.1
                            rectangle: self.x, self.y, self.width, self.height
                    text: 'RECEIVE'
                    on_press:
                        app.root.current = "Receive"
                        root.manager.transition.direction = "left"

                Button:
                    size_hint: 1, 1
                    halign: "auto"
                    valign: "middle"
                    font_name: "Arial Black"
                    font_size:  main.font_size
                    color: 1,1,1,1
                    background_color: 0.6,1,0.8,1
                    canvas.before:
                        Color:
                            rgba: (0,0.7,0,1)
                        Line:
                            width: 2.1
                            rectangle: self.x, self.y, self.width, self.height
                    text: 'TRANSACTIONS'
                    on_press: main.update_balance()
                    
        BoxLayout:
            orientation: "vertical"
            canvas.before:
                Color:
                    rgba: (0.9,1,0.9,0.97)
                Rectangle:
                    size: self.size
                    pos: self.pos
            
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)
                
            Label:
                text: "OPTIONS"
                color: (0,0,0,1)

                   
                        
<SendScreen>:
    name: "Send"
    id: send
    BoxLayout:
        orientation: "vertical"
        padding: [10,10,10,10]
        BoxLayout:
            size_hint: 1,0.5
            id: address_source
            padding: [0,30,10,10]
            spacing: 10
            
            CheckBox:
                group: "addr_source"
                size_hint_x: .10
                

            BoxLayout:
                orientation: "vertical"
                spacing: 8
                Label:
                    color: 0,1,0,1
                    font_name: "Arial Black"
                    size_hint:None,0.2
                    halign: "left"
                    text: "to address:"
                TextInput:
                    id: address
                    size_hint:1,1
                    multiline: True
                    on_double_tap: send.paste()
                    #on_focus:
                        #send.paste()

        BoxLayout:
            size_hint: 1,1
            id: address_source
            #cols: 2
            padding: [0,30,20,30]
            #valign: "top"
            spacing: 10
            #size_hint: 1,None
            #row_force_default: True
            CheckBox:
                group: "addr_source"
                size_hint_x: .10
                on_active: 
                

            BoxLayout:
                orientation: "vertical"
                Label:
                    color: 0,1,0,1
                    font_name: "Arial Black"
                    size_hint:None,0.2
                    halign: "left"
                    text: "From QRcode:"
                AsyncImage:
                    source: 'https://cdn.osxdaily.com/wp-content/uploads/2017/10/read-qr-code-iphone-ipad.jpg'
                    size_hint: 1, 1
                    size: 280,280
                    pos_hint: {'center_x':.5, 'center_y': .5}      

        BoxLayout:
            padding: [30,10,30,10]
            spacing: 25
            orientation: "vertical"
            
            GridLayout:
                spacing: 2
                cols: 2
                Label:
                    font_name: "Arial Black"
                    color: 0,1,0,1
                    size_hint:1,0.3
                    halign: "left"
                    text: "Amount :  "
                Label:
                    font_name: "Arial Black"
                    color: 0,1,0,1
                    size_hint:None,0.3
                    halign: "left"
                    text: "Units:"
                TextInput:
                    id: amount
                    padding: [30,0,0,0]
                    size_hint:1,0.3
                    halign: "right"
                    multiline: False 
                Spinner:
                    id: denomination
                    font_name: "Arial Black"
                    color: 0,1,0,1
                    size_hint:None,0.3
                    halign: "left"
                    text: "Bitcoins"
                    values: "Bitcoins","Satoshis"
            Button:
                text:"SEND"
                on_press: send.confirm_popup()
                font_name: "Arial Black"
                font_size: "20sp"
                background_color: 0.6,1,0.8,1
                canvas.before:
                    Color:
                        rgba: (0,0.7,0,1)
                    Line:
                        width: 2.1
                        rectangle: self.x, self.y, self.width, self.height
            Button:
                size_hint: 1,0.5
                text:"GO BACK"
                font_size: "20sp"
                font_name: "Arial Black"
                background_color: 0.6,1,0.8,1
                canvas.before:
                    Color:
                        rgba: (0,0.7,0,1)
                    Line:
                        width: 2.1
                        rectangle: self.x, self.y, self.width, self.height
                on_press:
                    app.root.current = "Main"
                    root.manager.transition.direction = "right"  
                    
                    
<ReceiveScreen>:
    id: receive
    name: "Receive"
    
    BoxLayout:
        orientation: "vertical"
        padding: [20,20,20,20]
        spacing:20
        
        Label:
            size_hint: 1,0.05
            font_name: "Arial Black"
            font_size: receive.label_font_size
            color: 0,1,0,1
            text: "Choose an Address source:"
            multiline: True
        
        BoxLayout:
            orientation: "vertical"
            padding: [20,20,20,20]
            spacing:20
            size_hint: 1, 1
            
            canvas:
                Color:
                    rgba: (0,1,0,1)
                Line:
                    width: 2.1
                    rectangle: self.x, self.y, self.width, self.height
        
            Label:
                size_hint: 1, 0.2
                font_name: "Arial Black"
                font_size: receive.label_font_size
                color: 0,1,0,1                
                valign:"bottom"
                text: "From an anused adrress:"
            
            ToggleSpinner:
                id: existing_addr
                font_name: "Arial Black"
                font_size: "20sp"
                background_color: 0.6,1,0.8,1
                canvas.before:
                    Color:
                        rgba: (0,0.7,0,1)
                    Line:
                        width: 2.1
                        rectangle: self.x, self.y, self.width, self.height
                group: "address_source"
                size_hint: 1, 0.7
                size: 280, 100
                #pos_hint: {'center': (.5, .5)}
                text: 'P2PKH (default)'
                values: 'P2PKH (default)', 'P2WPKH','P2SH_P2WPKH'
                on_press: 
                    #receive.activate_spinner()
                on_value:
                    #print: "The spinner {} has text {}".format(self, self.value)

            Label:
                size_hint: 1, 0.2
                font_name: "Arial Black"
                font_size: receive.label_font_size
                color: 0,1,0,1                
                valign:"bottom"
                text: "Or from new adrress:"

            ToggleSpinner:
                id: new_addr
                font_name: "Arial Black"
                font_size: "20sp"
                background_color: 0.6,1,0.8,1
                canvas.before:
                    Color:
                        rgba: (0,0.7,0,1)
                    Line:
                        width: 2.1
                        rectangle: self.x, self.y, self.width, self.height
                group: "address_source"
                size_hint: 1, 0.7
                size: 280, 100
                #pos_hint: {'center': (.5, .5)}
                text: 'P2PKH (default)'
                values: 'P2PKH (default)', 'P2WPKH','P2SH_P2WPKH'
                on_press: 
                    #receive.activate_spinner()
                on_value:
                    #print: "The spinner {} has text {}".format(self, self.value)
                    
        Label:
            size_hint: 1,0.5
            font_name: "Arial Black"
            font_size: receive.label_font_size
            color: 0,1,0,1
            text: "Now, Press 'Show QR Code',\nor choose any other option.'"
            halign: "center"
            multiline: True
            
        Button:
            size_hint: 1,0.4
            font_name: "Arial Black"
            font_size: "20sp"
            background_color: 0.6,1,0.8,1
            size: 280, 100
            text:"Show QR Code"
            on_press: receive.qr_popup()  
            canvas.before:
                Color:
                    rgba: (0,0.7,0,1)
                Line:
                    width: 2.1
                    rectangle: self.x, self.y, self.width, self.height
        
        
        Button:
            size_hint: 1,0.2
            size: 280, 100
            font_name: "Arial Black"
            font_size: "20sp"
            background_color: 0.6,1,0.8,1
            padding: 0,50
            text:"GO BACK"
            on_press:
                app.root.current = "Main"
                root.manager.transition.direction = "right"  
                
            canvas.before:
                Color:
                    rgba: (0,0.7,0,1)
                Line:
                    width: 2.1
                    rectangle: self.x, self.y, self.width, self.height
                
        Button:
            size_hint: 1,0.2
            font_name: "Arial Black"
            font_size: "20sp"
            background_color: 0.6,1,0.8,1
            size: 280, 100
            text:"INFO"
            #on_press: POPUP INFO
            canvas.before:
                Color:
                    rgba: (0,0.7,0,1)
                Line:
                    width: 2.1
                    rectangle: self.x, self.y, self.width, self.height
        



#<ConfirmSendPopup>:
    #id: confirm_tx
    #Label:
        #text: "Are you sure you want \nto send xx.xxx BTC to adress\n abc666lkp1233?"
        #halign: "center"
        #size_hint: 0.6,0.3
        #pos_hint: {"x":0.2, "top":1}
        
    #Slider:
        #pos_hint: {"x":0, "y":-0.02}
        #min: 0
        #max: 30
        #step: 1
        #value_track: True
        #value_trak_color: [1,0,0,1]
        #orientation: 'horizontal'
        #on_value: 
            #root.checkout(*args)
            #value_trak_color: [1-args[1]/30, args[1]/30, 0, 1]
            

    #Button:
        #id: YES
        #pos_hint: {"x":0, "y":-0.02}
        #size_hint: 1,0.4
        #text: "YES"
        #on_release: root.exit()
        #on_release: root.root.cancel_tx()
        
        

    
